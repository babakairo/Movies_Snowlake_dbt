
================================================================================
  MODERN DATA ENGINEERING PLATFORM â€” ARCHITECTURE DIAGRAM
  Dataset: The Movie Database (TMDb) API
  Stack:   Python Â· Snowflake Â· dbt Â· Medallion Architecture
================================================================================

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           DATA SOURCES                                      â”‚
â”‚                                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚
â”‚   â”‚         TMDb REST API (api.themoviedb.org)    â”‚                          â”‚
â”‚   â”‚  â€¢ GET /movie/popular   (paginated list)      â”‚                          â”‚
â”‚   â”‚  â€¢ GET /movie/{id}      (full movie detail)   â”‚                          â”‚
â”‚   â”‚  â€¢ GET /genre/movie/list (genre reference)    â”‚                          â”‚
â”‚   â”‚  Free API Key â€” 40 req/10s rate limit         â”‚                          â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚  HTTPS/JSON
                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     INGESTION LAYER  (Python)                               â”‚
â”‚                                                                             â”‚
â”‚   src/                                                                      â”‚
â”‚   â”œâ”€â”€ config.py      â† Loads .env, validates credentials                   â”‚
â”‚   â”œâ”€â”€ extract.py     â† TMDbExtractor: pagination, retry, rate-limit        â”‚
â”‚   â”œâ”€â”€ load.py        â† SnowflakeLoader: connection, bulk insert            â”‚
â”‚   â””â”€â”€ main.py        â† Orchestrates extract â†’ load pipeline                â”‚
â”‚                                                                             â”‚
â”‚   Key patterns: tenacity retries, structured logging, batch inserts         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚  snowflake-connector-python
                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    â„  SNOWFLAKE  (LECTURE_DE database)                     â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  ğŸ¥‰ BRONZE SCHEMA  (Raw Ingestion Zone)                              â”‚  â”‚
â”‚  â”‚                                                                      â”‚  â”‚
â”‚  â”‚  RAW_MOVIES          RAW_GENRES                                      â”‚  â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                               â”‚  â”‚
â”‚  â”‚  movie_id  NUMBER    raw_data   VARIANT                              â”‚  â”‚
â”‚  â”‚  raw_data  VARIANT   ingested_at TIMESTAMP                           â”‚  â”‚
â”‚  â”‚  source_url VARCHAR  batch_id    VARCHAR                             â”‚  â”‚
â”‚  â”‚  ingested_at TIMESTAMP                                               â”‚  â”‚
â”‚  â”‚  batch_id   VARCHAR                                                  â”‚  â”‚
â”‚  â”‚                                                                      â”‚  â”‚
â”‚  â”‚  Purpose: Immutable landing zone. Never transform here.              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                              â”‚ dbt ref()                                    â”‚
â”‚                              â–¼                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  ğŸ¥ˆ SILVER SCHEMA  (Cleansed & Structured)                          â”‚  â”‚
â”‚  â”‚                                                                      â”‚  â”‚
â”‚  â”‚  silver_movies          silver_genres                                â”‚  â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                           â”‚  â”‚
â”‚  â”‚  movie_id  PK           genre_id  PK                                 â”‚  â”‚
â”‚  â”‚  title                  genre_name                                   â”‚  â”‚
â”‚  â”‚  release_date (DATE)                                                 â”‚  â”‚
â”‚  â”‚  budget_usd             silver_movie_genres                          â”‚  â”‚
â”‚  â”‚  revenue_usd            â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                       â”‚  â”‚
â”‚  â”‚  vote_average           movie_id  FK                                 â”‚  â”‚
â”‚  â”‚  popularity             genre_id  FK                                 â”‚  â”‚
â”‚  â”‚  runtime_minutes                                                     â”‚  â”‚
â”‚  â”‚  original_language      silver_production_companies                  â”‚  â”‚
â”‚  â”‚  status                 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                   â”‚  â”‚
â”‚  â”‚  _loaded_at             company_id  PK                               â”‚  â”‚
â”‚  â”‚  _source                company_name                                 â”‚  â”‚
â”‚  â”‚                         origin_country                               â”‚  â”‚
â”‚  â”‚  Purpose: Type-safe, deduplicated, analytics-ready rows.             â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                              â”‚ dbt ref()                                    â”‚
â”‚                              â–¼                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  ğŸ¥‡ GOLD SCHEMA  (Business Analytics Layer)                         â”‚  â”‚
â”‚  â”‚                                                                      â”‚  â”‚
â”‚  â”‚  FACTS                  DIMENSIONS                                   â”‚  â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                   â”‚  â”‚
â”‚  â”‚  fact_movies            dim_genres                                   â”‚  â”‚
â”‚  â”‚    movie_sk (PK)          genre_sk (PK)                             â”‚  â”‚
â”‚  â”‚    date_sk (FK)           genre_id                                   â”‚  â”‚
â”‚  â”‚    genre_sk (FK)          genre_name                                 â”‚  â”‚
â”‚  â”‚    company_sk (FK)                                                   â”‚  â”‚
â”‚  â”‚    revenue_usd          dim_dates                                    â”‚  â”‚
â”‚  â”‚    budget_usd             date_sk (PK)                               â”‚  â”‚
â”‚  â”‚    profit_usd             full_date                                  â”‚  â”‚
â”‚  â”‚    roi_pct                year / quarter / month                     â”‚  â”‚
â”‚  â”‚    vote_average           day_of_week                                â”‚  â”‚
â”‚  â”‚    vote_count             is_weekend                                 â”‚  â”‚
â”‚  â”‚    popularity                                                        â”‚  â”‚
â”‚  â”‚                         dim_production_companies                     â”‚  â”‚
â”‚  â”‚  KPI MARTS               company_sk (PK)                            â”‚  â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   company_name                               â”‚  â”‚
â”‚  â”‚  kpi_genre_performance   origin_country                              â”‚  â”‚
â”‚  â”‚  kpi_yearly_trends                                                   â”‚  â”‚
â”‚  â”‚  kpi_top_movies                                                      â”‚  â”‚
â”‚  â”‚                                                                      â”‚  â”‚
â”‚  â”‚  Purpose: Business answers, BI-tool ready, aggregated KPIs.          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

================================================================================
  DATA FLOW SUMMARY
================================================================================

  [TMDb API] â”€â”€HTTPâ”€â”€â–º [Python extract.py]
                              â”‚
                              â–¼
                    [Python load.py] â”€â”€SQLâ”€â”€â–º [BRONZE.RAW_MOVIES]
                                                      â”‚
                                              dbt run (bronze models)
                                                      â”‚
                                                      â–¼
                                             [SILVER.silver_movies]
                                             [SILVER.silver_genres]
                                             [SILVER.silver_movie_genres]
                                             [SILVER.silver_production_companies]
                                                      â”‚
                                              dbt run (gold models)
                                                      â”‚
                                                      â–¼
                                             [GOLD.fact_movies]
                                             [GOLD.dim_genres]
                                             [GOLD.dim_dates]
                                             [GOLD.dim_production_companies]
                                             [GOLD.kpi_genre_performance]
                                             [GOLD.kpi_yearly_trends]
                                             [GOLD.kpi_top_movies]
                                                      â”‚
                                              dbt test (schema + custom)
                                                      â”‚
                                                      â–¼
                                          [BI Tool / Analyst Queries]

================================================================================
  WAREHOUSE ARCHITECTURE
================================================================================

  ACCOUNT:      <your_account>.snowflakecomputing.com
  DATABASE:     LECTURE_DE
  SCHEMAS:      BRONZE | SILVER | GOLD
  WAREHOUSES:   LECTURE_INGEST_WH (Python loads) XS
                LECTURE_TRANSFORM_WH (dbt runs)   S
  ROLES:        SYSADMIN
                DE_ROLE          (data engineers)
                ANALYST_ROLE     (read-only Gold)

================================================================================
